(function(e){function t(t){for(var a,o,s=t[0],l=t[1],c=t[2],u=0,p=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&p.push(n[o][0]),n[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);m&&m(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,o=1;o<r.length;o++){var l=r[o];0!==n[l]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={app:0},i=[];function o(e){return s.p+"js/"+({about:"about"}[e]||e)+"."+{about:"f3c7ab93"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((function(t,a){r=n[e]=[t,a]}));t.push(r[2]=a);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=o(e);var c=new Error;i=function(t){l.onerror=l.onload=null,clearTimeout(u);var r=n[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,r[1](c)}n[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/vrm-avatar-editor/",s.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var m=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"0bc1":function(e,t,r){},"2d59":function(e,t,r){"use strict";r("5898")},5021:function(e,t,r){"use strict";r("a352")},5898:function(e,t,r){},"5ced":function(e,t,r){},"7d55":function(e,t,r){},"8d62":function(e,t,r){"use strict";r("7d55")},"9b19":function(e,t,r){e.exports=r.p+"img/logo.63a7d78d.svg"},a352:function(e,t,r){},ab30:function(e,t,r){"use strict";r("c2fc")},c2fc:function(e,t,r){},cccb:function(e,t,r){"use strict";r("5ced")},cd49:function(e,t,r){"use strict";r.r(t);var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-main",[r("router-view")],1)],1)},i=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",{staticClass:"text-center"},[a("v-col",{attrs:{cols:"12"}},[a("v-img",{staticClass:"my-3",attrs:{src:r("9b19"),contain:"",height:"200"}})],1),a("v-col",{staticClass:"mb-4"},[a("h1",{staticClass:"display-2 font-weight-bold mb-3"},[e._v("Welcome to Vuetify")]),a("p",{staticClass:"subheading font-weight-regular"},[e._v(" For help and collaboration with other Vuetify developers, "),a("br"),e._v("please join our online "),a("a",{attrs:{href:"https://community.vuetifyjs.com",target:"_blank"}},[e._v("Discord Community")])])]),a("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[a("h2",{staticClass:"headline font-weight-bold mb-3"},[e._v("What's next?")]),a("v-row",{attrs:{justify:"center"}},e._l(e.whatsNext,(function(t,r){return a("a",{key:r,staticClass:"subheading mx-3",attrs:{href:t.href,target:"_blank"}},[e._v(" "+e._s(t.text)+" ")])})),0)],1),a("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[a("h2",{staticClass:"headline font-weight-bold mb-3"},[e._v("Important Links")]),a("v-row",{attrs:{justify:"center"}},e._l(e.importantLinks,(function(t,r){return a("a",{key:r,staticClass:"subheading mx-3",attrs:{href:t.href,target:"_blank"}},[e._v(" "+e._s(t.text)+" ")])})),0)],1),a("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[a("h2",{staticClass:"headline font-weight-bold mb-3"},[e._v("Ecosystem")]),a("v-row",{attrs:{justify:"center"}},e._l(e.ecosystem,(function(t,r){return a("a",{key:r,staticClass:"subheading mx-3",attrs:{href:t.href,target:"_blank"}},[e._v(" "+e._s(t.text)+" ")])})),0)],1)],1)],1)},s=[],l=a["a"].extend({name:"HelloWorld",data:()=>({ecosystem:[{text:"vuetify-loader",href:"https://github.com/vuetifyjs/vuetify-loader"},{text:"github",href:"https://github.com/vuetifyjs/vuetify"},{text:"awesome-vuetify",href:"https://github.com/vuetifyjs/awesome-vuetify"}],importantLinks:[{text:"Documentation",href:"https://vuetifyjs.com"},{text:"Chat",href:"https://community.vuetifyjs.com"},{text:"Made with Vuetify",href:"https://madewithvuejs.com/vuetify"},{text:"Twitter",href:"https://twitter.com/vuetifyjs"},{text:"Articles",href:"https://medium.com/vuetify"}],whatsNext:[{text:"Explore components",href:"https://vuetifyjs.com/components/api-explorer"},{text:"Select a layout",href:"https://vuetifyjs.com/getting-started/pre-made-layouts"},{text:"Frequently Asked Questions",href:"https://vuetifyjs.com/getting-started/frequently-asked-questions"}]})}),c=l,u=r("2877"),m=r("6544"),p=r.n(m),h=r("62ad"),d=r("a523"),f=r("adda"),v=r("0fd9"),b=Object(u["a"])(c,o,s,!1,null,null,null),g=b.exports;p()(b,{VCol:h["a"],VContainer:d["a"],VImg:f["a"],VRow:v["a"]});var y=a["a"].extend({name:"App",components:{HelloWorld:g},data:()=>({})}),O=y,_=r("7496"),w=r("f6c4"),x=Object(u["a"])(O,n,i,!1,null,null,null),I=x.exports;p()(x,{VApp:_["a"],VMain:w["a"]});var j=r("8c4f"),S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home full"},[r("v-app-bar",{attrs:{danse:"",dark:"",id:"app-bar"}},[r("v-toolbar-title",[e._v("VRM Avatar Editor")]),r("v-spacer"),r("v-btn",{attrs:{href:"https://github.com/gatosyocora/vrm-avatar-editor/issues/new",target:"_blank"}},[e._v("Issue")]),r("v-btn",{attrs:{href:"https://github.com/gatosyocora/vrm-avatar-editor",target:"_blank"}},[e._v("GitHub")]),r("v-btn",{attrs:{href:"https://github.com/gatosyocora/vrm-avatar-editor/blob/main/README.md",target:"_blank"}},[e._v("License")]),r("v-btn",{attrs:{icon:""},on:{click:e.reloadPage}},[r("v-icon",[e._v("mdi-cached")])],1)],1),r("p",{staticClass:"unselectable",attrs:{id:"message"}},[e._v(" ローカル環境で処理しているため、VRMファイルをサーバーにアップロードしていません。 ")]),r("div",{attrs:{id:"menu"}},[r("v-card",{staticClass:"full-height"},[r("v-tabs",{attrs:{"fixed-tabs":"",dark:""}},[r("v-tab",{class:{active:0===e.currentTab},on:{click:function(t){return e.changeTab(0)}}},[e._v("Meta")]),r("v-tab",{class:{active:1===e.currentTab},on:{click:function(t){return e.changeTab(1)}}},[e._v("Materials")]),r("v-tab",{class:{active:2===e.currentTab},on:{click:function(t){return e.changeTab(2)}}},[e._v("Model")]),r("v-tab",{class:{active:3===e.currentTab},on:{click:function(t){return e.changeTab(3)}}},[e._v("BlendShape")])],1),r("div",{staticClass:"full-height"},[r("div",{directives:[{name:"show",rawName:"v-show",value:0===e.currentTab,expression:"currentTab === 0"}],staticClass:"contents"},[r("MetaView",{attrs:{meta:e.meta,exporterVersion:e.exporterVersion}},[r("ExportButton",{attrs:{vrm:e.vrm}})],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:1===e.currentTab,expression:"currentTab === 1"}],staticClass:"contents"},[r("MaterialView",{attrs:{materials:e.materials},on:{onChangeMaterial:e.updateMaterial}})],1),r("div",{directives:[{name:"show",rawName:"v-show",value:2===e.currentTab,expression:"currentTab === 2"}],staticClass:"contents"},[r("ModelInfoView",{attrs:{vrmObject:e.vrmObject,materials:e.materials}})],1),r("div",{directives:[{name:"show",rawName:"v-show",value:3===e.currentTab,expression:"currentTab === 3"}],staticClass:"contents"},[r("BlendShapeView",{attrs:{vrmObject:e.vrmObject},on:{updateBlendShape:e.updateBlendShape}})],1)])],1)],1),r("div",{staticClass:"full",attrs:{id:"main"}},[r("div",{staticClass:"top full"},[null===e.vrmObject?r("DragAndDroppableArea",{staticClass:"layer2 layer full",on:{onDropFile:e.loadVrm}},[r("div",{staticClass:"white-color unselectable"},[r("center",[e._v(" VRMをドラッグ&ドロップ"),r("br"),r("br"),r("label",{staticClass:"my-file-button black--text"},[e._v(" ファイルを選択 "),r("input",{attrs:{type:"file",accept:".vrm"},on:{change:e.onFileChange}})])])],1)]):e._e(),r("VRMCanvas",{staticClass:"layer1 layer full",attrs:{vrmObject:e.vrmObject}})],1)])],1)},N=[],T=r("9ab4"),E=r("60a3"),M=r("34ad"),D=r("f7e7"),A=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("canvas",{attrs:{id:"canvas"}})},B=[],V=r("5a89"),R=r("4721");let C=class extends E["e"]{constructor(){super(...arguments),this.scene=null,this.renderer=null,this.camera=new V["PerspectiveCamera"](75,window.innerWidth/window.innerHeight,.1,1e3),this.light=new V["DirectionalLight"](16777215,1),this.gridHelper=new V["GridHelper"](10,10),this.axesHelper=new V["AxesHelper"](5),this.controls=null}mounted(){const e=document.getElementById("canvas");null!==e&&(e.width=window.innerWidth,e.height=window.innerHeight,this.renderer=new V["WebGLRenderer"]({antialias:!0,canvas:e}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.camera.position.set(0,1,-1.5),this.camera.rotation.set(0,Math.PI,0),this.controls=new R["a"](this.camera,this.renderer.domElement),this.controls.screenSpacePanning=!0,this.controls.target.set(0,1,0),this.controls.update(),this.light.position.set(0,0,-10),this.initScene())}animate(){this.scene&&(requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera))}updateVrm(e){this.scene&&(this.vrmObject&&this.initScene(),this.vrmObject=e,null!==e&&this.scene.add(this.vrmObject))}initScene(){this.scene=new V["Scene"],this.scene.add(this.light),this.scene.add(this.gridHelper),this.scene.add(this.axesHelper),this.animate()}};Object(T["a"])([Object(E["d"])("scene")],C.prototype,"scene",void 0),Object(T["a"])([Object(E["c"])()],C.prototype,"meta",void 0),Object(T["a"])([Object(E["c"])()],C.prototype,"materials",void 0),Object(T["a"])([Object(E["c"])()],C.prototype,"vrmObject",void 0),Object(T["a"])([Object(E["f"])("vrmObject",{immediate:!0})],C.prototype,"updateVrm",null),C=Object(T["a"])([E["a"]],C);var L=C,U=L,k=Object(u["a"])(U,A,B,!1,null,null,null),P=k.exports,G=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.meta?r("div",[r("v-simple-table",[r("tbody",[r("tr",[r("td",[e._v("Title")]),r("td",[e._v(e._s(e.meta.title))])]),r("tr",[r("td",[e._v("Version")]),r("td",[e._v(e._s(e.meta.version))])]),r("tr",[r("td",[e._v("Author")]),r("td",[e._v(e._s(e.meta.author))])]),r("tr",[r("td",[e._v("Allow User")]),r("td",[e._v(e._s(e.meta.allowedUserName))])]),r("tr",[r("td",[e._v("Commercial Ussage")]),r("td",[e._v(e._s(e.meta.commercialUssageName))])]),r("tr",[r("td",[e._v("Sexual Ussage")]),r("td",[e._v(e._s(e.meta.sexualUssageName))])]),r("tr",[r("td",[e._v("Violent Ussage")]),r("td",[e._v(e._s(e.meta.violentUssageName))])]),r("tr",[r("td",[e._v("License Name")]),r("td",[e._v(e._s(e.meta.licenseName))])]),r("tr",[r("td",[e._v("Other License")]),r("td",[r("a",{attrs:{href:e.meta.otherLicenseUrl,target:"_blank"}},[e._v(" "+e._s(e.meta.otherLicenseUrl)+" ")])])]),r("tr",[r("td",[e._v("Other Permission")]),r("td",[r("a",{attrs:{href:e.meta.otherPermissionUrl,target:"_blank"}},[e._v(" "+e._s(e.meta.otherPermissionUrl)+" ")])])]),r("tr",[r("td",[e._v("Contact Information")]),r("td",[r("a",{attrs:{href:e.meta.contactInformation,target:"_blank"}},[e._v(" "+e._s(e.meta.contactInformation)+" ")])])]),r("tr",[r("td",[e._v("Reference")]),r("td",[e._v(e._s(e.meta.reference))])]),r("tr",[r("td",[e._v("Icon")]),r("td",[r("DragAndDroppableArea",{on:{onDropFile:e.changeIconFile}},[r("ImageBitmapImg",{attrs:{imageBitmap:e.meta.texture?e.meta.texture.image:void 0,showInfo:!1}})],1)],1)]),r("tr",[r("td",[e._v("Exporter Version")]),r("td",[e._v(e._s(e.exporterVersion))])])])]),e._t("default")],2):e._e()},F=[],H=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{margin:"0 10px 0 10px",display:"inline-block"}},[r("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var a=t.hover;return[r("v-list-item-avatar",{staticStyle:{margin:"5px"},attrs:{rounded:"",size:"80",color:"white"}},[e.imageBitmap?r("v-img",{attrs:{src:e.convertImageBitmap2Base64(e.imageBitmap)}},[e.showInfo&&a?r("div",{staticClass:"tex-info unselectable"},[e._v(" "+e._s(e.imageBitmap.width)+"x"+e._s(e.imageBitmap.height)+" ")]):e._e()]):r("span",{staticStyle:{color:"black"}},[e._v(" none ")])],1)]}}])})],1)},z=[];let q=class extends E["e"]{convertImageBitmap2Base64(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toDataURL()}};Object(T["a"])([Object(E["c"])()],q.prototype,"imageBitmap",void 0),Object(T["a"])([Object(E["c"])({default:!0})],q.prototype,"showInfo",void 0),q=Object(T["a"])([E["a"]],q);var X=q,$=X,W=(r("5021"),r("ce87")),Y=r("8270"),K=Object(u["a"])($,H,z,!1,null,null,null),J=K.exports;p()(K,{VHover:W["a"],VImg:f["a"],VListItemAvatar:Y["a"]});var Q=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"fit-inline",class:{outline:e.isDragOver},on:{dragover:function(t){return t.preventDefault(),e.onDrag("over")},dragleave:function(t){return t.preventDefault(),e.onDrag("leave")},drop:function(t){return t.preventDefault(),e.onDrop(t)}}},[e._t("default")],2)},Z=[];let ee=class extends E["e"]{onDrag(e){this.isDragOver="over"===e}onDrop(e){if(null===e.dataTransfer||null===e.dataTransfer.files)return;this.isDragOver=!1;const t=e.dataTransfer.files[0],r=window.URL.createObjectURL(t);this.$emit("onDropFile",r)}};Object(T["a"])([Object(E["c"])({default:!1})],ee.prototype,"isDragOver",void 0),ee=Object(T["a"])([E["a"]],ee);var te=ee,re=te,ae=(r("2d59"),Object(u["a"])(re,Q,Z,!1,null,null,null)),ne=ae.exports;function ie(e){return new Promise((t,r)=>{const a=new Image;a.onload=()=>t(createImageBitmap(a)),a.onerror=e=>r(e),a.src=e})}let oe=class extends E["e"]{getMeshCount(e){return e.filter(e=>["Group","SkinnedMesh"].includes(e.type)).length}getPolygonCount(e){return e.filter(e=>["Group","SkinnedMesh","Object3D"].includes(e.type)).map(e=>["Group","Object3D"].includes(e.type)?e.children.length<=0?0:e.children.map(e=>e.geometry.groups[0].count).reduce((e,t)=>e+t,0):"SkinnedMesh"===e.type?e.geometry.groups[0].count:e.children.map(e=>e.geometry.groups[0].count).reduce((e,t)=>e+t,0)).reduce((e,t)=>e+t,0)/3}getBlendShapeCount(e){let t=0;return e.forEach(e=>{"Group"===e.type&&(t+=e.children[0].geometry.userData.targetNames.length)}),t}async changeIconFile(e){if(this.meta){const t=await ie(e);if(!t)return;this.meta.texture||(this.meta.texture=new V["Texture"]),this.meta.texture.image=t}}};Object(T["a"])([Object(E["c"])()],oe.prototype,"meta",void 0),Object(T["a"])([Object(E["c"])()],oe.prototype,"vrmObject",void 0),Object(T["a"])([Object(E["c"])()],oe.prototype,"exporterVersion",void 0),oe=Object(T["a"])([Object(E["a"])({components:{ImageBitmapImg:J,DragAndDroppableArea:ne}})],oe);var se=oe,le=se,ce=(r("dc9f"),r("1f4f")),ue=Object(u["a"])(le,G,F,!1,null,null,null),me=ue.exports;p()(ue,{VSimpleTable:ce["a"]});var pe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.materials?r("div",e._l(e.toUniqueMaterialInfos(e.materials),(function(t,a){return r("div",{key:a},[r("MaterialItem",{attrs:{materialInfo:t},on:{onChangeMaterial:e.changeMaterial}})],1)})),0):e._e()},he=[],de=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"card",attrs:{dark:""}},[r("v-list-item",{attrs:{"three-line":""}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"headline"},[e._v(" "+e._s(e.materialInfo.material.name)+" ")]),r("v-list-item-subtitle",[e._v(" "+e._s(e.materialInfo.material.userData.vrmMaterialProperties.shader)+" ")]),r("v-list-item-subtitle",[0===e.materialInfo.material.side?r("div",[e._v("FrontSide")]):1===e.materialInfo.material.side?r("div",[e._v("BackSide")]):r("div",[e._v("BothSide")])])],1),e.materialInfo.material.color?r("v-list-item-avatar",{attrs:{size:"80",color:e.convertRGB2Hex(e.materialInfo.material.color)}}):e._e(),r("DragAndDroppableArea",{on:{onDropFile:e.updateTexture}},[e.materialInfo.material.map&&e.materialInfo.material.map.image?r("ImageBitmapImg",{attrs:{imageBitmap:e.materialInfo.material.map.image}}):e._e()],1)],1)],1)},fe=[];let ve=class extends E["e"]{convertRGB2Hex(e){const t=Math.round(255*Number(e.x)),r=Math.round(255*Number(e.y)),a=Math.round(255*Number(e.z));return"#"+t.toString(16)+r.toString(16)+a.toString(16)}changeHsv(){const e=this.materialInfo.material;if(!e.map)return;const t=e.map.image,r=document.createElement("canvas");r.width=t.width,r.height=t.height;const a=r.getContext("2d");a.drawImage(t,0,0),this.changeColorForDot(a,t,e=>{const t=this.rgb2hsv(e);return t.h=255*this.materialInfo.value,this.hsv2rgb(t)});const n=r.toDataURL();this.updateTexture(n)}changeColorForDot(e,t,r){const a=e.getImageData(0,0,t.width,t.height),n=a.data;for(let i=0;i<n.length;i+=4){let e={r:255*n[i+0],g:255*n[i+1],b:255*n[i+2],a:255*n[i+3]};e=r(e),n[i+0]=e.r/255,n[i+1]=e.g/255,n[i+2]=e.b/255,n[i+3]=e.a/255}e.putImageData(a,0,0)}rgb2hsv(e){const t=e.r/255,r=e.g/255,a=e.b/255,n=Math.max(t,r,a),i=Math.min(t,r,a),o=n-i;let s;s=i===n?0:i===t?(a-r)/o*60+180:i===r?(t-a)/o*60+300:i===a?(r-t)/o*60+60:0;const l=0==n?0:o/n,c=n;return{h:s,s:l,v:c,a:e.a}}hsv2rgb(e){const t=e.h/60,r=e.s,a=e.v;if(0==r)return{r:255*a,g:255*a,b:255*a,a:e.a};var n,i=parseInt(""+t),o=t-i,s=a*(1-r),l=a*(1-r*o),c=a*(1-r*(1-o));return n=0===i||6===i?[a,c,s]:1===i?[l,a,s]:2===i?[s,a,c]:3===i?[s,l,a]:4===i?[c,s,a]:5===i?[a,s,l]:[0,0,0],{r:255*n[0],g:255*n[1],b:255*n[2],a:e.a}}async updateTexture(e){const t=this.materialInfo.material;if(t&&t.map){const r=await ie(e);t.map.image=r,this.$emit("onChangeMaterial",t)}}};Object(T["a"])([Object(E["c"])()],ve.prototype,"materialInfo",void 0),ve=Object(T["a"])([Object(E["a"])({components:{ImageBitmapImg:J,DragAndDroppableArea:ne}})],ve);var be=ve,ge=be,ye=(r("8d62"),r("b0af")),Oe=r("da13"),_e=r("5d23"),we=Object(u["a"])(ge,de,fe,!1,null,null,null),xe=we.exports;p()(we,{VCard:ye["a"],VListItem:Oe["a"],VListItemAvatar:Y["a"],VListItemContent:_e["a"],VListItemSubtitle:_e["b"],VListItemTitle:_e["c"]});let Ie=class extends E["e"]{toUniqueMaterialInfos(e){const t=Array();for(let r=0;r<e.length;r++){const a=t.map(e=>e.name).indexOf(e[r].name);-1===a?t.push({name:e[r].name,material:e[r],indices:[r],value:0}):t[a].indices.push(r)}return t}changeMaterial(e){this.$emit("onChangeMaterial",e)}};Object(T["a"])([Object(E["c"])()],Ie.prototype,"materials",void 0),Object(T["a"])([Object(E["c"])()],Ie.prototype,"uniqueMaterialInfos",void 0),Ie=Object(T["a"])([Object(E["a"])({components:{MaterialItem:xe}})],Ie);var je=Ie,Se=je,Ne=Object(u["a"])(Se,pe,he,!1,null,null,null),Te=Ne.exports,Ee=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.vrmObject?r("div",[r("v-simple-table",[r("tbody",[null!==e.vrmObject.children?r("tr",[r("td",[e._v("Mesh Count")]),r("td",[e._v(e._s(e.getMeshCount(e.vrmObject.children)))]),r("td")]):e._e(),null!==e.materials?r("tr",[r("td",[e._v("SubMesh Count")]),r("td",[e._v(e._s(e.materials.length))]),r("td")]):e._e(),null!==e.vrmObject.children?r("tr",[r("td",[e._v("Polygon Count")]),r("td",[e._v(e._s(e.getPolygonCount(e.vrmObject.children)))]),r("td")]):e._e(),null!==e.vrmObject.children?r("tr",[r("td",[e._v("Bone Count")]),r("td",[e._v(e._s(e.getBoneCount(e.vrmObject.children)))]),r("td",[r("ShowBoneButton")],1)]):e._e(),null!==e.vrmObject.children?r("tr",[r("td",[e._v("BlendShape Count")]),r("td",[e._v(e._s(e.getBlendShapeCount(e.vrmObject.children)))]),r("td")]):e._e()])])],1):e._e()},Me=[],De=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-btn",{staticStyle:{width:"50px"},on:{click:function(t){e.isShowing?e.hideBone():e.showBone()}}},[e.isShowing?r("div",[e._v("Hide")]):r("div",[e._v("Show")])])},Ae=[];let Be=class extends E["e"]{showBone(){if(!this.vrmObject||!this.scene||this.isShowing)return;const e=this.vrmObject.children.filter(e=>e.children.length>0&&"Bone"===e.children[0].type)[0];this.boneObject=this.generateBoneSupporter(e),this.scene.add(this.boneObject),this.isShowing=!0}hideBone(){this.boneObject&&this.scene&&this.isShowing&&(this.scene.remove(this.boneObject),this.isShowing=!1)}generateBoneSupporter(e,t,r){r||(r=new V["LineBasicMaterial"]({color:16711680,transparent:!0,depthWrite:!1,depthTest:!1}));const a=new V["BufferGeometry"];if(t){const r=new Array;r.push(t.getWorldPosition(new V["Vector3"](0,0,0)),e.getWorldPosition(new V["Vector3"](0,0,0))),a.setFromPoints(r)}const n=new V["Line"](a,r);return n.name=e.name,e.children.forEach(t=>{n.children.push(this.generateBoneSupporter(t,e,r))}),n}};Object(T["a"])([Object(E["b"])("vrmObject")],Be.prototype,"vrmObject",void 0),Object(T["a"])([Object(E["b"])("scene")],Be.prototype,"scene",void 0),Object(T["a"])([Object(E["c"])({default:!1})],Be.prototype,"isShowing",void 0),Be=Object(T["a"])([E["a"]],Be);var Ve=Be,Re=Ve,Ce=r("8336"),Le=Object(u["a"])(Re,De,Ae,!1,null,null,null),Ue=Le.exports;p()(Le,{VBtn:Ce["a"]});let ke=class extends E["e"]{getMeshCount(e){return e.filter(e=>["Group","SkinnedMesh"].includes(e.type)).length}getPolygonCount(e){return e.filter(e=>["Group","SkinnedMesh"].includes(e.type)).map(e=>"Group"===e.type?e.children[0].geometry.attributes.position.count:e.geometry.attributes.position.count).reduce((e,t)=>e+t,0)}getBoneCount(e){return this.getChildrenCount(e.filter(e=>e.children.length>0&&"Bone"===e.children[0].type)[0])}getChildrenCount(e){return 0===e.children.length?0:e.children.map(e=>this.getChildrenCount(e)).reduce((e,t)=>e+t,0)+e.children.length}getBlendShapeCount(e){let t=0;return e.forEach(e=>{if("Group"===e.type){const r=e.children[0].geometry.userData;t+=r.targetNames?r.targetNames.length:0}else if("SkinnedMesh"===e.type){const r=e.geometry.userData;t+=r.targetNames?r.targetNames.length:0}}),t}};Object(T["a"])([Object(E["c"])()],ke.prototype,"materials",void 0),Object(T["a"])([Object(E["c"])()],ke.prototype,"vrmObject",void 0),ke=Object(T["a"])([Object(E["a"])({components:{ShowBoneButton:Ue}})],ke);var Pe=ke,Ge=Pe,Fe=Object(u["a"])(Ge,Ee,Me,!1,null,null,null),He=Fe.exports;p()(Fe,{VSimpleTable:ce["a"]});var ze,qe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-btn",{attrs:{block:"",color:"primary",disabled:!e.vrm},on:{click:e.exportVRM}},[e._v(" Export VRM (beta) ")])},Xe=[];function $e(e,t,r){return{allowedUserName:e.allowedUserName,author:e.author,commercialUssageName:e.commercialUssageName,contactInformation:e.contactInformation,licenseName:e.licenseName,otherLicenseUrl:e.otherLicenseUrl,otherPermissionUrl:e.otherPermissionUrl,reference:e.reference,sexualUssageName:e.sexualUssageName,texture:t?r.length-1:void 0,title:e.title,version:e.version,violentUssageName:e.violentUssageName}}(function(e){e[e["ARRAY_BUFFER"]=34962]="ARRAY_BUFFER",e[e["ELEMENT_ARRAY_BUFFER"]=34963]="ELEMENT_ARRAY_BUFFER",e[e["BYTE"]=5120]="BYTE",e[e["UNSIGNED_BYTE"]=5121]="UNSIGNED_BYTE",e[e["SHORT"]=5122]="SHORT",e[e["UNSIGNED_SHORT"]=5123]="UNSIGNED_SHORT",e[e["UNSIGNED_INT"]=5125]="UNSIGNED_INT",e[e["FLOAT"]=5126]="FLOAT",e[e["LINEAR"]=9729]="LINEAR",e[e["REPEAT"]=10497]="REPEAT"})(ze||(ze={}));const We="blend_",Ye="BlendShapeController_",Ke="vrmColliderSphere",Je="UniVRM-0.64.0";class Qe{parse(e,t){const r=e.scene,a=e.humanoid,n=e.meta,i=e.materials,o=e.blendShapeProxy,s=e.lookAt,l=e.springBoneManager,c={generator:"UniGLTF-2.0.0",version:"2.0"};if(!r)throw new Error("scene is undefined or null");if(!a)throw new Error("humanoid is undefined or null");if(!n)throw new Error("meta is undefined or null");if(!i)throw new Error("materials is undefined or null");if(!o)throw new Error("blendShapeProxy is undefined or null");if(!s)throw new Error("lookAt is undefined or null");if(!l)throw new Error("springBone is undefined or null");const u=i.filter((e,t,r)=>r.findIndex(t=>t.name===e.name)===t).map(e=>e),m=u.map(e=>e.name),p=n.texture?{name:"icon",imageBitmap:n.texture.image}:null,h=u.filter(e=>e.map).map(e=>{if(!e.map)throw new Error(e.name+" map is null");return{name:e.name,imageBitmap:e.map.image}}),d=ft(h,p),f=vt(d),v=bt(d),b=dt(u,h),g=r.children.filter(e=>e.children.length>0&&e.children[0].type===mt.Bone)[0],y=et(g).filter(e=>e.name!==Ke),O=y.map(e=>e.name),_=y.map(e=>({children:e.children.filter(e=>e.name!==Ke).map(e=>O.indexOf(e.name)),name:e.name,rotation:[e.quaternion.x,e.quaternion.y,e.quaternion.z,e.quaternion.w],scale:[e.scale.x,e.scale.y,e.scale.z],translation:[e.position.x,e.position.y,e.position.z]})),w=[],x=r.children.filter(e=>e.type===mt.Group||e.type===mt.SkinnedMesh),I=[];x.forEach(e=>{const t=e.type===mt.Group?e.children[0]:e,r=t.geometry.attributes;I.push(new st(r.position,ze.FLOAT,ut.POSITION,ct.VEC3,t.name,void 0)),I.push(new st(r.normal,ze.FLOAT,ut.NORMAL,ct.VEC3,t.name,void 0)),I.push(new st(r.uv,ze.FLOAT,ut.UV,ct.VEC2,t.name,void 0)),I.push(new st(r.skinWeight,ze.FLOAT,ut.SKIN_WEIGHT,ct.VEC4,t.name,void 0)),I.push(new st(r.skinIndex,ze.UNSIGNED_SHORT,ut.SKIN_INDEX,ct.VEC4,t.name,void 0));const a=e.type===mt.Group?e.children.map(e=>e):[e];if(a.forEach(e=>{if(!e.geometry.index)throw new Error(e.name+" geometry.index is null");I.push(new st(e.geometry.index,ze.UNSIGNED_INT,ut.INDEX,ct.SCALAR,t.name,e.name))}),!t.morphTargetDictionary)throw new Error(t.name+" morphTargetDictionary is null");const n=Object.entries(t.morphTargetDictionary);t.geometry.userData.targetNames&&t.geometry.userData.targetNames.forEach(e=>{const r=n.filter(t=>t[0]===e)[0][1],a=t.geometry.morphAttributes;I.push(new st(a.position[r],ze.FLOAT,ut.BLEND_POSITION,ct.VEC3,t.name,We+e)),I.push(new st(a.normal[r],ze.FLOAT,ut.BLEND_NORMAL,ct.VEC3,t.name,We+e))})}),x.forEach(e=>{const t=e.type===mt.Group?e.children[0]:e,r=new Float32Array(t.skeleton.boneInverses.map(e=>e.elements).flat());I.push(new st(new V["BufferAttribute"](r,16),ze.FLOAT,ut.BIND_MATRIX,ct.MAT4,t.name,t.name))}),w.push(...I.map(e=>({bufferView:-1,byteOffset:0,componentType:e.valueType,count:e.attribute.count,max:e.max,min:e.min,normalized:!1,type:e.accessorsType})));const j=pt(x,I,m);x.forEach((e,t)=>{_.push({mesh:t,name:e.name,rotation:[e.quaternion.x,e.quaternion.y,e.quaternion.z,e.quaternion.w],scale:[e.scale.x,e.scale.y,e.scale.z],skin:t,translation:[e.position.x,e.position.y,e.position.z]})});const S=r.children.filter(e=>"secondary"===e.name)[0];_.push({name:S.name,rotation:[S.quaternion.x,S.quaternion.y,S.quaternion.z,S.quaternion.w],scale:[S.scale.x,S.scale.y,S.scale.z],translation:[S.position.x,S.position.y,S.position.z]});const N=ht(x,I,O),T={blendShapeGroups:Object.values(o._blendShapeGroups).map(e=>({binds:e._binds.map(e=>({index:e.morphTargetIndex,mesh:j.map(e=>e.name).indexOf(e.meshes[0].name),weight:100*e.weight})),isBinary:e.isBinary,materialValues:e._materialValues,name:e.name.replace(Ye,""),presetName:Object.entries(o.blendShapePresetMap).filter(t=>t[1]===e.name.replace(Ye,""))[0][0]}))};s.firstPerson._firstPersonBoneOffset.z*=-1;const E={firstPersonBone:O.indexOf(s.firstPerson._firstPersonBone.name),firstPersonBoneOffset:s.firstPerson._firstPersonBoneOffset,lookAtHorizontalInner:{curve:s.applyer._curveHorizontalInner.curve,xRange:Ze(s.applyer._curveHorizontalInner.curveXRangeDegree),yRange:Ze(s.applyer._curveHorizontalInner.curveYRangeDegree)},lookAtHorizontalOuter:{curve:s.applyer._curveHorizontalOuter.curve,xRange:Ze(s.applyer._curveHorizontalOuter.curveXRangeDegree),yRange:Ze(s.applyer._curveHorizontalOuter.curveYRangeDegree)},lookAtTypeName:s.applyer.type,lookAtVerticalDown:{curve:s.applyer._curveVerticalDown.curve,xRange:Ze(s.applyer._curveVerticalDown.curveXRangeDegree),yRange:Ze(s.applyer._curveVerticalDown.curveYRangeDegree)},lookAtVerticalUp:{curve:s.applyer._curveVerticalUp.curve,xRange:Ze(s.applyer._curveVerticalUp.curveXRangeDegree),yRange:Ze(s.applyer._curveVerticalUp.curveYRangeDegree)},meshAnnotations:s.firstPerson.meshAnnotations.map(e=>({firstPersonFlag:0===e.firstPersonFlag?"Auto":"",mesh:j.map(e=>e.name).indexOf(e.mesh.children.length>0?e.mesh.children[0].name:e.mesh.name)}))},M={armStretch:a.humanDescription.armStretch,feetSpacing:a.humanDescription.feetSpacing,hasTranslationDoF:a.humanDescription.hasTranslationDoF,humanBones:Object.entries(a.humanBones).filter(e=>e[1].length>0).map(e=>({bone:e[0],node:O.indexOf(e[1][0].node.name),useDefaultValues:!0})),legStretch:a.humanDescription.legStretch,lowerArmTwist:a.humanDescription.lowerArmTwist,lowerLegTwist:a.humanDescription.lowerLegTwist,upperArmTwist:a.humanDescription.upperArmTwist,upperLegTwist:a.humanDescription.upperLegTwist},D=i.map(e=>e.userData.vrmMaterialProperties),A=$e(n,p,d),B=yt(l,O),R=[];R.push(...h.map(e=>({buffer:tt(e.imageBitmap),type:ut.IMAGE}))),R.push(...I.map(e=>({buffer:e.buffer,type:e.type}))),p&&R.push({buffer:tt(p.imageBitmap),type:ut.IMAGE});let C=0,L=0,U=0;const k=R.map((e,t)=>{const r={buffer:0,byteLength:e.buffer.byteLength,byteOffset:C,target:e.type===ut.IMAGE||e.type===ut.BIND_MATRIX?void 0:e.type===ut.INDEX?ze.ELEMENT_ARRAY_BUFFER:ze.ARRAY_BUFFER};return C+=e.buffer.byteLength,e.type===ut.IMAGE?d[L++].bufferView=t:w[U++].bufferView=t,r}),P=gt(r,_),G={accessors:w,asset:c,buffers:[{byteLength:C}],bufferViews:k,extensions:{VRM:{blendShapeMaster:T,exporterVersion:Je,firstPerson:E,humanoid:M,materialProperties:D,meta:A,secondaryAnimation:B,specVersion:"0.0"}},extensionsUsed:["KHR_materials_unlit","KHR_texture_transform","VRM"],images:d,materials:b,meshes:j,nodes:_,samplers:f,scene:0,scenes:P,skins:N,textures:v},F=new ot(at(JSON.stringify(G,void 0,2)),"JSON"),H=new ot(nt(R.map(e=>e.buffer)),"BIN\0"),z=nt([F.buffer,H.buffer]),q=nt([at("glTF"),rt(2,4),rt(z.byteLength+12,4)]);t(nt([q,z]))}}function Ze(e){return e*(180/Math.PI)}function et(e){return e.children.length<=0?[e]:[e].concat(e.children.map(e=>et(e)).flat())}function tt(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0);const r=t.toDataURL("image/png"),a=atob(r.split(",")[1]),n=new ArrayBuffer(a.length),i=new DataView(n);for(let o=0;o<a.length;o++)i.setUint8(o,a.charCodeAt(o));return n}function rt(e,t){const r=new ArrayBuffer(t),a=new DataView(r);return a.setUint32(0,e,!0),r}function at(e){return(new TextEncoder).encode(e).buffer}function nt(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n].byteLength;const r=new Uint8Array(t);let a=0;for(let n=0;n<e.length;++n)r.set(new Uint8Array(e[n]),a),a+=e[n].byteLength;return r.buffer}function it(e,t){const r=t===ze.UNSIGNED_SHORT?2:4,a=e.array;let n=0;const i=new ArrayBuffer(e.count*e.itemSize*r),o=new DataView(i);for(let s=0;s<e.count;s++)for(let i=0;i<e.itemSize;i++){let l;l=e.itemSize>4?a[s*e.itemSize+i]:0===i?e.getX(s):1===i?e.getY(s):2===i?e.getZ(s):e.getW(s),t===ze.UNSIGNED_SHORT?o.setUint16(n,l,!0):t===ze.UNSIGNED_INT?o.setUint32(n,l,!0):o.setFloat32(n,l,!0),n+=r}return i}class ot{constructor(e,t){this.data=e,this.type=t;const r=this.data;this.buffer=nt([rt(r.byteLength,4),at(this.type),r])}paddingBinary(e,t){const r=4*Math.ceil(e.byteLength/4);if(e.byteLength===r)return e;const a=new Uint8Array(r);a.set(new Uint8Array(e),0);for(let n=e.byteLength;n<r;n++)a.set(new Uint8Array(t),n);return a.buffer}}class st{constructor(e,t,r,a,n,i){this.attribute=e,this.type=r,this.valueType=t,this.accessorsType=a,this.meshName=n,this.name=i,this.buffer=it(this.attribute,this.valueType),this.max=r===ut.POSITION||r===ut.BLEND_POSITION?[Math.max.apply(null,Array.from(this.attribute.array).filter((e,t)=>t%3===0)),Math.max.apply(null,Array.from(this.attribute.array).filter((e,t)=>t%3===1)),Math.max.apply(null,Array.from(this.attribute.array).filter((e,t)=>t%3===2))]:void 0,this.min=r===ut.POSITION||r===ut.BLEND_POSITION?[Math.min.apply(null,Array.from(this.attribute.array).filter((e,t)=>t%3===0)),Math.min.apply(null,Array.from(this.attribute.array).filter((e,t)=>t%3===1)),Math.min.apply(null,Array.from(this.attribute.array).filter((e,t)=>t%3===2))]:void 0}}var lt,ct,ut,mt;(function(e){e["MeshBasicMaterial"]="MeshBasicMaterial",e["MeshStandardMaterial"]="MeshStandardMaterial",e["MToonMaterial"]="MToonMaterial"})(lt||(lt={})),function(e){e["SCALAR"]="SCALAR",e["VEC2"]="VEC2",e["VEC3"]="VEC3",e["VEC4"]="VEC4",e["MAT4"]="MAT4"}(ct||(ct={})),function(e){e["POSITION"]="POSITION",e["NORMAL"]="NORMAL",e["UV"]="UV",e["INDEX"]="INDEX",e["SKIN_WEIGHT"]="SKIN_WEIGHT",e["SKIN_INDEX"]="SKIN_INDEX",e["BLEND_POSITION"]="BLEND_POSITION",e["BLEND_NORMAL"]="BLEND_NORMAL",e["BIND_MATRIX"]="BIND_MATRIX",e["IMAGE"]="IMAGE"}(ut||(ut={})),function(e){e["Group"]="Group",e["SkinnedMesh"]="SkinnedMesh",e["Object3D"]="Object3D",e["Bone"]="Bone"}(mt||(mt={}));const pt=(e,t,r)=>e.map(e=>{const a=e.type===mt.Group?e.children[0]:e,n=e.type===mt.Group?e.children.map(e=>e):[e];return{extras:{targetNames:a.geometry.userData.targetNames},name:a.name,primitives:n.map(e=>{const n=t.map(e=>e.meshName===a.name?e.type:null),i=Array.isArray(e.material)?e.material[0].name:e.material.name;return{attributes:{JOINTS_0:n.indexOf(ut.SKIN_INDEX),NORMAL:n.indexOf(ut.NORMAL),POSITION:n.indexOf(ut.POSITION),TEXCOORD_0:n.indexOf(ut.UV),WEIGHTS_0:n.indexOf(ut.SKIN_WEIGHT)},extras:{targetNames:e.geometry.userData.targetNames},indices:t.map(e=>e.type===ut.INDEX&&e.meshName===a.name?e.name:null).indexOf(e.name),material:r.indexOf(i),mode:4,targets:a.geometry.userData.targetNames?a.geometry.userData.targetNames.map(e=>({NORMAL:t.map(e=>e.type===ut.BLEND_NORMAL&&e.meshName===a.name?e.name:null).indexOf(We+e),POSITION:t.map(e=>e.type===ut.BLEND_POSITION&&e.meshName===a.name?e.name:null).indexOf(We+e)})):void 0}})}}),ht=(e,t,r)=>e.map(e=>{const a=e.type===mt.Group?e.children[0]:e;return{inverseBindMatrices:t.map(e=>e.type===ut.BIND_MATRIX?e.meshName:null).indexOf(a.name),joints:a.skeleton.bones.map(e=>r.indexOf(e.name)),skeleton:r.indexOf(a.skeleton.bones[0].name)}}),dt=(e,t)=>e.map(e=>{let r;if(e.type===lt.MToonMaterial){const t=e;r=t.color?[t.color.x,t.color.y,t.color.z,t.color.w]:void 0}else{const t=e;r=t.color?[t.color.r,t.color.g,t.color.b,1]:void 0}const a=e.map?{extensions:{KHR_texture_transform:{offset:[0,0],scale:[1,1]}},index:t.map(e=>e.name).indexOf(e.name),texCoord:0}:void 0,n=(()=>{switch(e.type){case lt.MeshStandardMaterial:return e.metalness;case lt.MeshBasicMaterial:return 0;default:return.5}})(),i=(()=>{switch(e.type){case lt.MeshStandardMaterial:return e.roughness;case lt.MeshBasicMaterial:return.9;default:return.5}})();return{alphaCutoff:e.alphaTest>0?e.alphaTest:void 0,alphaMode:e.transparent?"BLEND":e.alphaTest>0?"MASK":"OPAQUE",doubleSided:2===e.side,extensions:e.type===lt.MeshBasicMaterial?{KHR_materials_unlit:{}}:void 0,name:e.name,pbrMetallicRoughness:{baseColorFactor:r,baseColorTexture:a,metallicFactor:n,roughnessFactor:i}}}),ft=(e,t)=>(t?e.concat(t):e).filter(e=>e&&e.imageBitmap).map(e=>({bufferView:-1,mimeType:"image/png",name:e.name})),vt=e=>e.map(()=>({magFilter:ze.LINEAR,minFilter:ze.LINEAR,wrapS:ze.REPEAT,wrapT:ze.REPEAT})),bt=e=>e.map((e,t)=>({sampler:t,source:t})),gt=(e,t)=>{const r=t.map(e=>e.name);return[{nodes:e.children.filter(e=>e.type===mt.Object3D||e.type===mt.SkinnedMesh||e.type===mt.Group).map(e=>r.indexOf(e.name))}]},yt=(e,t)=>({boneGroups:e.springBoneGroupList[0]&&e.springBoneGroupList[0].length>0?e.springBoneGroupList.map(r=>({bones:r.map(e=>t.indexOf(e.bone.name)),center:r[0].center?t.indexOf(r[0].center.name):-1,colliderGroups:e.colliderGroups.map((e,t)=>t),dragForce:r[0].dragForce,gravityDir:{x:r[0].gravityDir.x,y:r[0].gravityDir.y,z:r[0].gravityDir.z},gravityPower:r[0].gravityPower,hitRadius:r[0].radius,stiffiness:r[0].stiffnessForce})):[{bones:[],center:-1,colliderGroups:[],dragForce:.4,gravityDir:{x:0,y:-1,z:0},gravityPower:0,hitRadius:.02,stiffiness:1}],colliderGroups:e.colliderGroups.map(e=>({colliders:[{offset:{x:e.colliders[0].position.x,y:e.colliders[0].position.y,z:e.colliders[0].position.z},radius:e.colliders[0].geometry.boundingSphere?e.colliders[0].geometry.boundingSphere.radius:void 0}],node:e.node}))});let Ot=class extends E["e"]{exportVRM(){if(!this.vrm)return;const e=new Qe;e.parse(this.vrm,e=>{const t="test.vrm",r=new Blob([e],{type:"octet/stream"}),a=document.createElement("a");a.href=URL.createObjectURL(r),a.download=t,a.click()})}};Object(T["a"])([Object(E["c"])()],Ot.prototype,"vrm",void 0),Ot=Object(T["a"])([E["a"]],Ot);var _t=Ot,wt=_t,xt=Object(u["a"])(wt,qe,Xe,!1,null,null,null),It=xt.exports;p()(xt,{VBtn:Ce["a"]});var jt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.vrmObject?r("div",e._l(e.blendShapeInfos,(function(t,a){return r("div",{key:a},[t.morphNames.length>0?r("v-simple-table",[r("thead",[r("tr",[r("th",[e._v(e._s(t.meshName))]),r("th",{staticStyle:{width:"70%"}})])]),r("tbody",e._l(t.morphNames,(function(n,i){return r("tr",{key:i},[r("td",[e._v(e._s(n))]),r("td",[r("v-slider",{attrs:{min:"0",max:"100"},on:{input:function(t){return e.updateBlendShape(a,i)}},model:{value:t.morphValues[i],callback:function(r){e.$set(t.morphValues,i,r)},expression:"blendShapeInfo.morphValues[morphIndex]"}})],1)])})),0)]):e._e()],1)})),0):e._e()},St=[];let Nt=class extends E["e"]{constructor(){super(...arguments),this.vrmObject=null,this.blendShapeInfos=void 0}LoadBlendShapeInfos(e){this.blendShapeInfos=e.children.filter(e=>"Group"===e.type||"SkinnedMesh"===e.type).map(e=>{const t="Group"===e.type?e.children[0]:e;return{meshName:e.name,morphNames:t.morphTargetDictionary?Object.keys(t.morphTargetDictionary):Array(),morphValues:t.morphTargetDictionary?Object.keys(t.morphTargetDictionary).map(e=>0):Array()}})}updateBlendShape(e,t){var r=0;this.blendShapeInfos&&(r=this.blendShapeInfos[e].morphValues[t]),this.$emit("updateBlendShape",{index:t,value:r})}};Object(T["a"])([Object(E["c"])()],Nt.prototype,"vrmObject",void 0),Object(T["a"])([Object(E["f"])("vrmObject")],Nt.prototype,"LoadBlendShapeInfos",null),Nt=Object(T["a"])([E["a"]],Nt);var Tt=Nt,Et=Tt,Mt=(r("ab30"),r("ba0d")),Dt=Object(u["a"])(Et,jt,St,!1,null,null,null),At=Dt.exports;p()(Dt,{VSimpleTable:ce["a"],VSlider:Mt["a"]});let Bt=class extends E["e"]{constructor(){super(...arguments),this.vrmObject=null}onFileChange(e){if(null===e.target.files)return;const t=e.target.files[0],r=window.URL.createObjectURL(t);this.loadVrm(r)}loadVrm(e){const t=new M["a"];t.load(e,e=>{console.log(e);const t=e.userData.gltfExtensions.VRM;this.exporterVersion=t.exporterVersion?t.exporterVersion:"UniVRM-"+t.version,console.log(this.exporterVersion),D["VRM"].from(e).then(e=>{this.vrm=e,this.meta=e.meta,this.materials=e.materials,this.vrmObject=e.scene,console.log(e)})},e=>console.log("Loading model...",e.loaded/e.total*100,"%"),e=>console.error(e))}updateMaterial(e){var t;null===(t=this.vrmObject)||void 0===t||t.traverse(t=>{if("SkinnedMesh"===t.type&&t.material[0].name===e.name){const r=e.clone();t.material[0]=r,r.needsUpdate=!0,r.map&&(r.map.needsUpdate=!0)}})}changeTab(e){this.currentTab=e}reloadPage(){location.reload()}updateBlendShape(e){var t;null===(t=this.vrmObject)||void 0===t||t.children.filter(e=>"Group"===e.type||"SkinnedMesh"===e.type).map(t=>{const r="Group"===t.type?t.children[0]:t;r.morphTargetInfluences&&(r.morphTargetInfluences[e.index]=e.value/100)})}};Object(T["a"])([Object(E["c"])()],Bt.prototype,"vrm",void 0),Object(T["a"])([Object(E["c"])()],Bt.prototype,"meta",void 0),Object(T["a"])([Object(E["c"])()],Bt.prototype,"materials",void 0),Object(T["a"])([Object(E["d"])("vrmObject")],Bt.prototype,"vrmObject",void 0),Object(T["a"])([Object(E["c"])()],Bt.prototype,"exporterVersion",void 0),Object(T["a"])([Object(E["c"])({default:0})],Bt.prototype,"currentTab",void 0),Bt=Object(T["a"])([Object(E["a"])({components:{VRMCanvas:P,MetaView:me,MaterialView:Te,ModelInfoView:He,ExportButton:It,DragAndDroppableArea:ne,BlendShapeView:At}})],Bt);var Vt=Bt,Rt=Vt,Ct=(r("cccb"),r("40dc")),Lt=r("132d"),Ut=r("2fa4"),kt=r("71a3"),Pt=r("fe57"),Gt=r("2a7f"),Ft=Object(u["a"])(Rt,S,N,!1,null,null,null),Ht=Ft.exports;p()(Ft,{VAppBar:Ct["a"],VBtn:Ce["a"],VCard:ye["a"],VIcon:Lt["a"],VSpacer:Ut["a"],VTab:kt["a"],VTabs:Pt["a"],VToolbarTitle:Gt["a"]}),a["a"].use(j["a"]);const zt=[{path:"/",name:"Home",component:Ht},{path:"/about",name:"About",component:()=>r.e("about").then(r.bind(null,"f820"))}],qt=new j["a"]({mode:"history",base:"/vrm-avatar-editor/",routes:zt});var Xt=qt,$t=r("2f62");a["a"].use($t["a"]);var Wt=new $t["a"].Store({state:{},mutations:{},actions:{},modules:{}}),Yt=r("f309");a["a"].use(Yt["a"]);var Kt=new Yt["a"]({});a["a"].config.productionTip=!1,new a["a"]({router:Xt,store:Wt,vuetify:Kt,render:e=>e(I)}).$mount("#app")},dc9f:function(e,t,r){"use strict";r("0bc1")}});
//# sourceMappingURL=app.213628bb.js.map